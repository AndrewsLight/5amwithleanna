function openMail(){ const gmail = 'https://mail.google.com/mail/?view=cm&fs=1&to=leanna@5amwithleanna.online&su=I%20said%20yes!'; const w=window.open(gmail,'_blank'); setTimeout(()=>{ if(!w || w.closed || typeof w.closed=='undefined') window.location.href='mailto:leanna@5amwithleanna.online'; },700); }
function startConfetti(x,y){ const colors=['#FFD58D','#FF8FB6','#B2A4FF','#FFC2A1']; for(let i=0;i<40;i++){ const p=document.createElement('div'); p.style.position='fixed'; p.style.left=(x)+'px'; p.style.top=(y)+'px'; p.style.width='8px'; p.style.height='10px'; p.style.background=colors[i%colors.length]; p.style.borderRadius='2px'; p.style.zIndex=9999; document.body.appendChild(p); const dx=(Math.random()-0.5)*600; const dy=Math.random()*400+100; const dur=900+Math.random()*900; p.animate([{transform:'translate(0,0)',opacity:1},{transform:'translate('+dx+'px,'+dy+'px) rotate('+Math.random()*360+'deg)',opacity:0}],{duration:dur,easing:'cubic-bezier(.2,.8,.2,1)'}); setTimeout(()=>p.remove(),dur+50); } }
function spawnHeart(x,y){ const el=document.createElement('div'); el.style.position='fixed'; el.style.left=(x)+'px'; el.style.top=(y)+'px'; el.style.fontSize='28px'; el.style.zIndex=9999; el.textContent='❤️'; document.body.appendChild(el); const dy=200+Math.random()*200; el.animate([{transform:'translateY(0)',opacity:1},{transform:'translateY(-'+dy+'px)',opacity:0}],{duration:2000+Math.random()*800,easing:'cubic-bezier(.2,.8,.2,1)'}); setTimeout(()=>el.remove(),2600); }
function yesFlowHandler(btnId){ const btn=document.getElementById(btnId); if(!btn) return; btn.addEventListener('click',async ()=>{ btn.disabled=true; const audio=document.getElementById('ambientAudio'); try{ if(audio) await audio.play(); }catch(e){} const rect=btn.getBoundingClientRect(); startConfetti(rect.left+rect.width/2, rect.top+rect.height/2); for(let i=0;i<8;i++) setTimeout(()=>spawnHeart(rect.left + Math.random()*rect.width, rect.top + Math.random()*rect.height), i*140); setTimeout(()=>{ const rev=document.getElementById('proposalReveal'); if(rev){ rev.style.display='block'; rev.textContent='Thank you for saying yes. Forever starts now.'; } localStorage.setItem('foreverUnlocked','1'); },700); setTimeout(()=>{ window.location.href='forever.html'; },3000); }); }
function initGallery(){ const grid=document.getElementById('galleryGrid'); if(!grid) return; const imgs=['assets/mem-default-1.jpg','assets/mem-default-2.jpg','assets/mem-default-1.jpg']; imgs.forEach(s=>{ const b=document.createElement('button'); b.className='tile'; b.innerHTML='<img src="'+s+'" style="width:100%;height:100%;object-fit:cover">'; b.addEventListener('click', ()=>{ const dlg=document.getElementById('lightbox'); document.getElementById('lbContent').innerHTML='<img src="'+s+'" style="width:100%">'; if(typeof dlg.showModal==='function') dlg.showModal(); else dlg.setAttribute('open',''); }); grid.appendChild(b); }); }
function renderLoveCounter(){ const el=document.getElementById('loveCounter'); if(!el) return; const start=new Date(localStorage.getItem('loveStart')||'2024-05-01T00:00:00Z'); const now=new Date(); let diff=Math.floor((now-start)/1000); const years=Math.floor(diff/(3600*24*365)); diff-=years*3600*24*365; const months=Math.floor(diff/(3600*24*30)); diff-=months*3600*24*30; const days=Math.floor(diff/(3600*24)); diff-=days*3600*24; const hours=Math.floor(diff/3600); el.textContent=years+'y '+months+'m '+days+'d '+hours+'h'; }
function renderCountdown(){ const el=document.getElementById('countdown'); if(!el) return; const targetStr = localStorage.getItem('weddingDate') || new Date(Date.now()+90*24*60*60*1000).toISOString(); const target = new Date(targetStr); function tick(){ const now=new Date(); let diff = Math.max(0,target-now); const days=Math.floor(diff/(1000*60*60*24)); diff-=days*24*60*60*1000; const hours=Math.floor(diff/(1000*60*60)); diff-=hours*60*60*1000; const minutes=Math.floor(diff/(1000*60)); diff-=minutes*60*1000; const seconds=Math.floor(diff/1000); el.textContent = days+'d '+hours+'h '+minutes+'m '+seconds+'s'; } tick(); setInterval(tick,1000); }
function loadAlbum(){ const grid=document.getElementById('albumGrid'); if(!grid) return; const placeholders=['assets/album-placeholder.jpg','assets/album-placeholder.jpg']; placeholders.forEach(p=>{ const d=document.createElement('div'); d.className='tile'; d.innerHTML='<img src="'+p+'" style="width:100%;height:100%;object-fit:cover">'; grid.appendChild(d); }); }
